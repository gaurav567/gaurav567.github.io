---
layout: post
title: Exploration of Water Usage and Affordability in the US
published: true
---

Water access, affordability, and quality have re-emerged as serious issues in the US and continue to be major problems in developing countries. I wanted to visualize the extent of this issue in the US using water price data and demographic information using clustering algorithms. Check out my repo on [github](https://github.com/pgr-me/metis_projects/tree/master/fletcher) for the code. 

## Methodology

I used univariate clustering on water usage, price, and income to identify municipalities and regions where water may be less affordable. Then, I performed a multivariate clustiner analysis to see how other factors, including demographic variables, may correlate with income and water usage and price. I obtained my demographic and geospatial data from the 2014 [US Census American Consumer Survey (ACS)](https://www.census.gov/programs-surveys/acs/) and price data from [Food and Water Watch](http://www.foodandwaterwatch.org/insight/priceless-market-myth-water-pricing-reform).

![Summary of methodology]({{site.baseurl}}/pgr-me.github.io/images/003-water-methodology.png)

## Univariate analysis of water utilities prices

To visualize water utilities pricing clusters, I used the [Jenks natural breaks classification method](https://en.wikipedia.org/wiki/Jenks_natural_breaks_optimization), which seeks to find optimal clusters of along a univariate set of data. Jenks works by minimizing the variance within classes and maximizes the variance between classes. The two maps below each show the same 400 water utilities prices grouped into five price clusters, but the first one uses the Jenks method and the second method splits each group evenly into five clusters. Each color represents a price cluster, and although the both maps may look similar at first glance, the jenks clustering scheme has a larger number of data points within the low price cluster than the quintile clustering scheme. The Jenks method suggests that prices are more concentrated at the lower end of the pricing specturm than the quintile method suggests. In both cases, higher water prices tend to be found in drought-stricken California and in pockets of the Midwest (including Flint, MI), Appalachia, and the Northeast.

<iframe width="100%" height="520" frameborder="0" src="https://peter-gray-rasmussen.cartodb.com/viz/8c7b607a-17dc-11e6-9ba6-0e31c9be1b51/embed_map" allowfullscreen webkitallowfullscreen mozallowfullscreen oallowfullscreen msallowfullscreen></iframe> 

<iframe width="100%" height="520" frameborder="0" src="https://peter-gray-rasmussen.cartodb.com/viz/eadb8856-1dfa-11e6-add5-0e787de82d45/embed_map" allowfullscreen webkitallowfullscreen mozallowfullscreen oallowfullscreen msallowfullscreen></iframe>

What should we make of the discrepancy between the Jenks and quintile clustering schemes? Which one is better? The answer is that it depends on how you want to segment your data. Quintiles are pre-defined, and can be useful for providing apples-to-apples comparisons across datasets. Jenks breaks, which are data-driven splits, may be more appropriate for doing exploratory analysis to identify natural clusters. 

## Multivariate analysis

Next, I wanted to see if certain demographics correlated with the univariate clusters. To do this, I conducted a multivariate analysis - k means clustering - that incorporated other data, including education, ethnicity, and income. 

The k in k means clustering represents the number of clusters, and the objective is to find the optimal number of k clusters using the most relevant features (e.g., water pricing, income, etc.). For k means clustering, it's vital to remove extraneous features to avoid the [curse of dimensionality](https://en.wikipedia.org/wiki/Curse_of_dimensionality). It's also important to select the lowest number of clusters that describe the grouping of the data.

The elbow plots below 

![Elbow plots]({{site.baseurl}}/pgr-me.github.io/images/003-water-elbow-plots.png)


The preliminary results of the multivariate analysis were inconclusive. The figure below is a matrix scatter plot of three color

The resultI was interested in 

![Distribution of lender loan activity]({{site.baseurl}}/pgr-me.github.io/images/001-microlending-hist.png)

The chart below shows that Kiva users tend to be based in the US and male. Additionaly, almost 20% of the sample is involved in the tech industry or sciences.

![Segment Splits]({{site.baseurl}}/pgr-me.github.io/images/001-microlending-splits.png)

I wanted to get an idea of the sample distribution by category, and so I created the chart below using [Seaborn](https://stanford.edu/~mwaskom/software/seaborn/). We can see that the distribution of people from the US and Canada seems to be more concentrated at the lower end of loans per year axis than those in the rest of the world. In addition, high loans per year outliers are primarily male.

![Categorical Scatter Plot]({{site.baseurl}}/pgr-me.github.io/images/001-microlending-scatter.png)

The statistical results are shown below. The R-squared value is low, and so the model's predictive power is nil. However, p values for the gender, region, invites per year, and lending reason features are low enough that we can reject the null hypothesis that these features have no impact on lending activity.

![Regression Statistics]({{site.baseurl}}/pgr-me.github.io/images/001-microlending-regstats.png)

## Conclusions and Next Steps

This is a preliminary analysis, and more insights could be gleaned from the Kiva data. Even so, we can draw the following conclusions from this analysis:

- Microlending activity across microlenders seems to be exponentially distributed;
- While the model developed for this analysis is not predictive, it does explain a subset of the types of people that tends to make more microloans;
- Within the sample data, males and people living outside the US and Canada tend to be more active microlenders; and,
- More analysis is needed before we can say the same for people involved in tech and the sciences.

Further analysis may show that the selected features for this model should be refined, removed, or added. With a more predictive model, I could move on to test the training data with test data to see if model is over or under fitted.
